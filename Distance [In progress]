#Attempting to Generalize Distance Script
# For some reason when you want to terminant the sequence, it will not accept a variabel
# it wants you to hard code the number 

# Function applies the Haversine formula to each longitutde latitude pair 
distanceCalcu <- function(x){
  cityHallLat <- 29.951065
  CityHallLong <- -90.071533
  city <- c(CityHallLong,cityHallLat)  
  
  x <- x[x$longitude < 360, ]
  y <- nrow(x)
  
  lat <- x$latitude[1 : nrow(x) ]
  long <- x$long[1: nrow(x) ]
  
  distancex <- seq( 1: nrow(x))
  
  for (i in 1: nrow(x)){
    lat <- x$latitude[i]
    long <- x$longitude[i]
    loc <- c(long,lat)
    
    distancex[i] <- distHaversine(loc,city )
  }
  print(distancex)
}

distanceRecyclingProgram <- distanceCalcu( recyclingProgram)

#Applies the distance function that finds the distance for each point in the dataframe to each dataframe in the dataset

lapply(list(abandonedVehicle, catchBasin, codeEnforcement, recyclingProgram, grassService,
                illegalDumping, potholeRepair, streetFlooding, treeServiceEmergency, largeItem,
                mosquitoControl, treeService, trafficSign, streetLight, generalService, trash,
                streetLight, rodentComplaint, streetSign, roadMarking, deadAnimalPickup, subsidence ,
                trafficSignal, roadShoulder, curbRepair, parkMaintenance, sidewalkRepair, treeMainteneance,
                park, manholeCover, otherAnimal, parkCompliant , parkGrass, inspection), distanceCalcu) 
